<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">	
	<title>upload</title>
	<!--[if lt IE 9]><script media="all">
	/**
	* @preserve HTML5 Shiv 3.7.2 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed
	*/
	!function(a,b){function c(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function d(){var a=y.elements;return"string"==typeof a?a.split(" "):a}function e(a,b){var c=y.elements;"string"!=typeof c&&(c=c.join(" ")),"string"!=typeof a&&(a=a.join(" ")),y.elements=c+" "+a,j(b)}function f(a){var b=x[a[v]];return b||(b={},w++,a[v]=w,x[w]=b),b}function g(a,c,d){if(c||(c=b),q)return c.createElement(a);d||(d=f(c));var e;return e=d.cache[a]?d.cache[a].cloneNode():u.test(a)?(d.cache[a]=d.createElem(a)).cloneNode():d.createElem(a),!e.canHaveChildren||t.test(a)||e.tagUrn?e:d.frag.appendChild(e)}function h(a,c){if(a||(a=b),q)return a.createDocumentFragment();c=c||f(a);for(var e=c.frag.cloneNode(),g=0,h=d(),i=h.length;i>g;g++)e.createElement(h[g]);return e}function i(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return y.shivMethods?g(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+d().join().replace(/[\w\-:]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(y,b.frag)}function j(a){a||(a=b);var d=f(a);return!y.shivCSS||p||d.hasCSS||(d.hasCSS=!!c(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),q||i(a,d),a}function k(a){for(var b,c=a.getElementsByTagName("*"),e=c.length,f=RegExp("^(?:"+d().join("|")+")$","i"),g=[];e--;)b=c[e],f.test(b.nodeName)&&g.push(b.applyElement(l(b)));return g}function l(a){for(var b,c=a.attributes,d=c.length,e=a.ownerDocument.createElement(A+":"+a.nodeName);d--;)b=c[d],b.specified&&e.setAttribute(b.nodeName,b.nodeValue);return e.style.cssText=a.style.cssText,e}function m(a){for(var b,c=a.split("{"),e=c.length,f=RegExp("(^|[\\s,>+~])("+d().join("|")+")(?=[[\\s,>+~#.:]|$)","gi"),g="$1"+A+"\\:$2";e--;)b=c[e]=c[e].split("}"),b[b.length-1]=b[b.length-1].replace(f,g),c[e]=b.join("}");return c.join("{")}function n(a){for(var b=a.length;b--;)a[b].removeNode()}function o(a){function b(){clearTimeout(g._removeSheetTimer),d&&d.removeNode(!0),d=null}var d,e,g=f(a),h=a.namespaces,i=a.parentWindow;return!B||a.printShived?a:("undefined"==typeof h[A]&&h.add(A),i.attachEvent("onbeforeprint",function(){b();for(var f,g,h,i=a.styleSheets,j=[],l=i.length,n=Array(l);l--;)n[l]=i[l];for(;h=n.pop();)if(!h.disabled&&z.test(h.media)){try{f=h.imports,g=f.length}catch(o){g=0}for(l=0;g>l;l++)n.push(f[l]);try{j.push(h.cssText)}catch(o){}}j=m(j.reverse().join("")),e=k(a),d=c(a,j)}),i.attachEvent("onafterprint",function(){n(e),clearTimeout(g._removeSheetTimer),g._removeSheetTimer=setTimeout(b,500)}),a.printShived=!0,a)}var p,q,r="3.7.2",s=a.html5||{},t=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,u=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,v="_html5shiv",w=0,x={};!function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",p="hidden"in a,q=1==a.childNodes.length||function(){b.createElement("a");var a=b.createDocumentFragment();return"undefined"==typeof a.cloneNode||"undefined"==typeof a.createDocumentFragment||"undefined"==typeof a.createElement}()}catch(c){p=!0,q=!0}}();var y={elements:s.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:r,shivCSS:s.shivCSS!==!1,supportsUnknownElements:q,shivMethods:s.shivMethods!==!1,type:"default",shivDocument:j,createElement:g,createDocumentFragment:h,addElements:e};a.html5=y,j(b);var z=/^$|\b(?:all|print)\b/,A="html5shiv",B=!q&&function(){var c=b.documentElement;return!("undefined"==typeof b.namespaces||"undefined"==typeof b.parentWindow||"undefined"==typeof c.applyElement||"undefined"==typeof c.removeNode||"undefined"==typeof a.attachEvent)}();y.type+=" print",y.shivPrint=o,o(b)}(this,document);
	</script><![endif]-->

	<script type="text/javascript">
		statusName = ["Unknown", "Initializing", "Polling", 
		              "Found File", "Uploading", "Finished"];
		
		function byid(id) {
			return document.getElementById(id);
		}
		
		function appletStatusChange() {
			byid("status").innerHTML = upload.status + " " + statusName[upload.status];
		}
		
		function appletInit() {
			// alert("applietInit");
			byid("dir").innerHTML = upload.dir;
			byid("target").innerHTML = upload.target;
		}
		
		function appletGotFile() {
			byid("file").innerHTML = upload.UploadFile;
		}
		
		function appletFinished() {
			byid("size").innerHTML = upload.fileSize;
			byid("statusCode").innerHTML = upload.statusCode;
			byid("mimeType").innerHTML = upload.mimeType;
		}
		
		function appletFailed() {
			alert("applietFailed");
		}
	</script>
	
	<style type="text/css">
	body {font-family: sans;}
	
	.label {
		display: block; 
		float: left;
		width: 110px;
		text-transform: capitalize;
	}
	
	.label::after {
		content: ": ";
	}
	
	.value {
		
	}
	</style>
</head>
<body>
	
	<h1>File upload JavaApplet</h1>
	
	<h2>Example</h2>
<pre><code>	&lt;applet id="upload"
	        code="upload.class" 
	        archive="upload.jar"
	        width="0" 
	        height="0"&gt;
		&lt;param name="dir" value="\Users\wus" /&gt;
		&lt;param name="name" value="scan" /&gt;
		&lt;param name="target" value="http://10.0.0.29/post.php" /&gt;
	&lt;/applet&gt;</code></pre>
	
	<applet id="upload"
	        code="upload.class" 
	        archive="upload.jar"
	        width="0" 
	        height="0">
		<param name="dir" value="/Users/wus/tmp" />
		<param name="name" value="scan" />
		<param name="target" value="http://10.0.0.29/post.php" />
	</applet>
	
	<h2>Status Information</h2>
	<div>
		<div>
			<span class="label">Status</span>
			<span class="value" id="status">-</span>
		</div>
	
		<div>
			<span class="label">dir</span>
			<span class="value" id="dir">-</span>
		</div>
	
		<div>
			<span class="label">target</span>
			<span class="value" id="target">-</span>
		</div>
	
		<div>
			<span class="label">file</span>
			<span class="value" id="file">-</span>
		</div>
	
		<div>
			<span class="label">size</span>
			<span class="value" id="size">-</span>
		</div>
	
		<div>
			<span class="label">mimeType</span>
			<span class="value" id="mimeType">-</span>
		</div>
	
		<div>
			<span class="label">StatusCode</span>
			<span class="value" id="statusCode">-</span>
		</div>
	
	</div>
	<br/><br/>
	
	<h2>Synopsis</h2>
	<p>This applet polls a local directory <em>dir</em> for newly created files. The first 
	   new created file is uploaded to <em>target</em>.</p>
	
	<p>the id parameter is important to be set if you want to communicate from JavaScript 
	   with the applet. This applet includes the following live connect functionality:</p>
	<h3>Public Variables</h3>
	<ul>
		<li>fileSize: bytes, becomes available once a new file becomes available in the poll directory and before upload starts.</li>
		<li>dir: the same as the dir applet attribute</li>
		<li>target: the same as the target  applet attribute</li>
		<li>UploadFile: file name of the file to be uploaded. becomes available once a new file in the poll directory is created</li>
		<li>statusCode: http response status, initially 0</li>
		<li>mimeType: string represenation of the file's mime-type. is available after successfull upload.</li>
		<li>status: status code
			<ol>
				<li value="0">init</li>
				<li>polling</li>
				<li>found file</li>
				<li>found file</li>
				<li>uploading</li>
				<li>finished</li>
			</ol>
		</li>
	</ul>
	<h3>JavaScript event handlers</h3>
	<p>The faollowing methods (if available) are called by the applet when an event happens:</p>
	<ul>
		<li>appletStatusChange(): whenever the status variable changes, this one is emmited.</li>
		<li>appletInit(): after successfull initialisation of the applet (just before starting to poll the directory)</li>
		<li>appletGotFile(): new file found in poll directory, it seems to be written completely. After this event, the fileZize variable is updated and now greater than 0</li>
		<li>appletFinished(): successfully finished uploading</li>
		<li>appletFailed(): something went wrong, no further info available. Use the java console for debugging.</li>
	</ul>
	<h3>Post values</h3>
	<p>The uploaded file will be posted with the post field name setd in the applets name parameter. If unset, it wil ldefault to "uploadedFile" (how creative! i know.)</p>
	<p>By default, 2 other fields are submitted: "size" (bytes) and  "content-type" which should show a string represenation of the file's Mime-type.</p>
	 
</body>
</html>

